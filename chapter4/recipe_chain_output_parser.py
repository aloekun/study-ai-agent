from langchain_core.prompt_values import ChatPromptTemplate
from langchain_openai import ChatOpenAI
from langchain_core.output_parsers import StrOutputParser

# Chain を使った例、出力はOutputParserを使って解析
prompt = ChatPromptTemplate.from_messages(
    [
        ("system", "ユーザーが入力した料理のレシピを考えてください"),
        ("human", "{dish}"),
    ]
)

model = ChatOpenAI(model_name="gpt-4o-mini", temperature=0)

chain = prompt | model | StrOutputParser()
output = chain.invoke({"dish": "ティラミス"})
print(output)

# 出力例
# ティラミスのレシピをご紹介します。これはイタリアの人気デザートで、コーヒー風味のクリーミーな層が特徴です。

# ### 材料（4人分）

# - マスカルポーネチーズ：250g
# - 生クリーム：200ml
# - 卵黄：2個
# - 砂糖：50g
# - エスプレッソコーヒー：150ml（冷ましたもの）
# - ココアパウダー：適量
# - サヴォイアルディ（ビスケット）：適量
# - バニラエッセンス：少々（お好みで）

# ### 作り方

# 1. **エスプレッソの準備**：
#    - エスプレッソを淹れ、冷ましておきます。

# 2. **クリームの準備**：
#    - ボウルに卵黄と砂糖を入れ、白っぽくなるまでよく混ぜます。
#    - マスカルポーネチーズを加え、滑らかになるまで混ぜます。
#    - 別のボウルで生クリームを泡立て、8分立てにします。
#    - 生クリームをマスカルポーネの混ぜ物に少しずつ加え、優しく混ぜ合わせます。

# 3. **ビスケットの準備**：
#    - サヴォイアルディをエスプレッソに軽く浸し、底に敷く容器に並べます。

# 4. **層を作る**：
#    - ビスケットの上にクリームを半分の量をのせ、平らにします。
#    - 再度、エスプレッソに浸したビスケットを重ね、その上に残りのクリームをのせます。

# 5. **冷やす**：
#    - ラップをかけて冷蔵庫で約4時間以上、できれば一晩冷やします。

# 6. **仕上げ**：
#    - 食べる前に、ココアパウダーをふりかけて完成です。

# ### 提供方法
# 冷やしたティラミスをスプーンで取り分けて、お皿に盛り付けてお楽しみください。お好みでコーヒーやリキュールを添えても良いでしょう。

# おいしいティラミスをお楽しみください！
